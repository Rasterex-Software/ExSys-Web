<div class="content-wrapper">
    <div class="toolbar">
        <div class="search">
            <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                <g clip-path="url(#clip0_3862_60983)">
                <path d="M15.4859 14.5735L11.6779 10.6129C12.657 9.44901 13.1934 7.98455 13.1934 6.45999C13.1934 2.89801 10.2954 0 6.73343 0C3.17145 0 0.273438 2.89801 0.273438 6.45999C0.273438 10.022 3.17145 12.92 6.73343 12.92C8.07065 12.92 9.34495 12.5167 10.4344 11.751L14.2714 15.7416C14.4318 15.9082 14.6475 16 14.8786 16C15.0974 16 15.305 15.9166 15.4626 15.7649C15.7974 15.4428 15.808 14.9085 15.4859 14.5735ZM6.73343 1.68522C9.3663 1.68522 11.5082 3.82713 11.5082 6.45999C11.5082 9.09286 9.3663 11.2348 6.73343 11.2348C4.10056 11.2348 1.95865 9.09286 1.95865 6.45999C1.95865 3.82713 4.10056 1.68522 6.73343 1.68522Z" fill="#BCC1CB"/>
                </g>
                <defs>
                <clipPath id="clip0_3862_60983">
                <rect width="16" height="16" fill="white"/>
                </clipPath>
                </defs>
            </svg>
            <input
                type="text"
                placeholder="Search..." />
        </div>
        <div style="flex-grow: 1;"></div>
        <div class="filter">
            <div style="color: #2C3648; font-size: 14px; display: flex; align-items: center;gap: 6px;">
                Show: <b>All</b>
                <svg style="cursor: pointer;" width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M6 8L10 12" stroke="#2C3648" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M14 8L10 12" stroke="#2C3648" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
            </div>
            <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M6.2526 2.08333C6.2526 1.6231 5.87951 1.25 5.41927 1.25C4.95903 1.25 4.58594 1.6231 4.58594 2.08333V2.91667C4.58594 3.3769 4.95903 3.75 5.41927 3.75C5.87951 3.75 6.2526 3.3769 6.2526 2.91667V2.08333Z" fill="#606C82"/>
                <path d="M15.4167 2.08333C15.4167 1.6231 15.0436 1.25 14.5833 1.25C14.1231 1.25 13.75 1.6231 13.75 2.08333V2.91667C13.75 3.3769 14.1231 3.75 14.5833 3.75C15.0436 3.75 15.4167 3.3769 15.4167 2.91667V2.08333Z" fill="#606C82"/>
                <path d="M1.66406 7.5V17.0833C1.66406 18.0037 2.41031 18.75 3.33073 18.75H16.6641C17.5845 18.75 18.3307 18.0037 18.3307 17.0833V7.5H1.66406ZM6.66406 15.8333C6.66406 16.2937 6.29115 16.6667 5.83073 16.6667H4.9974C4.53698 16.6667 4.16406 16.2937 4.16406 15.8333V15C4.16406 14.5396 4.53698 14.1667 4.9974 14.1667H5.83073C6.29115 14.1667 6.66406 14.5396 6.66406 15V15.8333ZM6.66406 11.25C6.66406 11.7104 6.29115 12.0833 5.83073 12.0833H4.9974C4.53698 12.0833 4.16406 11.7104 4.16406 11.25V10.4167C4.16406 9.95625 4.53698 9.58333 4.9974 9.58333H5.83073C6.29115 9.58333 6.66406 9.95625 6.66406 10.4167V11.25ZM11.2474 15.8333C11.2474 16.2937 10.8745 16.6667 10.4141 16.6667H9.58073C9.12031 16.6667 8.7474 16.2937 8.7474 15.8333V15C8.7474 14.5396 9.12031 14.1667 9.58073 14.1667H10.4141C10.8745 14.1667 11.2474 14.5396 11.2474 15V15.8333ZM11.2474 11.25C11.2474 11.7104 10.8745 12.0833 10.4141 12.0833H9.58073C9.12031 12.0833 8.7474 11.7104 8.7474 11.25V10.4167C8.7474 9.95625 9.12031 9.58333 9.58073 9.58333H10.4141C10.8745 9.58333 11.2474 9.95625 11.2474 10.4167V11.25ZM15.8307 15.8333C15.8307 16.2937 15.4578 16.6667 14.9974 16.6667H14.1641C13.7036 16.6667 13.3307 16.2937 13.3307 15.8333V15C13.3307 14.5396 13.7036 14.1667 14.1641 14.1667H14.9974C15.4578 14.1667 15.8307 14.5396 15.8307 15V15.8333ZM15.8307 11.25C15.8307 11.7104 15.4578 12.0833 14.9974 12.0833H14.1641C13.7036 12.0833 13.3307 11.7104 13.3307 11.25V10.4167C13.3307 9.95625 13.7036 9.58333 14.1641 9.58333H14.9974C15.4578 9.58333 15.8307 9.95625 15.8307 10.4167V11.25Z" fill="#606C82"/>
                <path d="M18.3307 6.66667V4.16667C18.3307 3.24625 17.5845 2.5 16.6641 2.5H16.2474V2.91667C16.2474 3.83583 15.4999 4.58333 14.5807 4.58333C13.6616 4.58333 12.9141 3.83583 12.9141 2.91667V2.5H7.08073V2.91667C7.08073 3.83583 6.33323 4.58333 5.41406 4.58333C4.4949 4.58333 3.7474 3.83583 3.7474 2.91667V2.5H3.33073C2.41031 2.5 1.66406 3.24625 1.66406 4.16667V6.66667H18.3307Z" fill="#606C82"/>
            </svg>
            <button class="btn btn-primary" (click)="onAddDocumentClick()">+ Add new</button>
        </div>
    </div>

    <ul class="nav-tabs">
        <li class="active">DOCUMENTS</li>
        <li>RECIPIENTS</li>
    </ul>

    <div (click)="onCompareClick()" style="margin-top: 16px; display: flex; align-items: center; justify-content: flex-end;">
        <button class="btn btn-primary btn-inverse" [disabled]="selectedDocuments.length !== 2">Compare</button>
    </div>

    <div class="grid">
        <div class="row">
            <div class="th"></div>
            <div class="th"></div>
            <div class="th">Document</div>
            <div class="th">Title</div>
            <div class="th">Status</div>
            <div class="th center">Revisions</div>
            <div class="th">Date uploaded</div>
            <div class="th"></div>
        </div>
        <div class="grid-body">
            <div class="row row-expandable" *ngFor="let document of documents">
                <div class="td expand" [class.expanded]="document.id == expandedDocument?.id" (click)="onExpandClick(document)">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M8 14L12 10" stroke="#0D41F9" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M8 6L12 10" stroke="#0D41F9" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </div>
                <ng-container *ngIf="!document.versions?.length; else lastVersionTemplate">
                    <div class="td check">
                        <co-checkbox [disabled]="isCompare || (selectedDocuments.length == 2 && !document.selected)" [value]="document.selected" (valueChange)="onCheck($event, document)"></co-checkbox>
                    </div>
                    <div class="td name" (click)="onDocumentClick(document)">{{document.name}}</div>
                    <div class="td">{{document.title}}</div>
                    <div class="td"><span class="status" [class.completed]="document.status == 'Completed'" [class.in-progress]="document.status == 'In progress'">{{document.status}}</span></div>
                    <div class="td center">{{document.versions?.length}}</div>
                    <div class="td">{{document.createdDate | date: "dd.MM.YYYY" }}</div>
                    <div class="td actions">
                        <svg [dropdownTriggerFor]="dropdown" class=".row-options-btn" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <circle cx="12" cy="12" r="12" fill="#F5F5F6"/>
                            <circle cx="12" cy="6" r="2" fill="#606C82"/>
                            <circle cx="12" cy="12" r="2" fill="#606C82"/>
                            <circle cx="12" cy="18" r="2" fill="#606C82"/>
                        </svg>
                        <co-dropdown-panel #dropdown>
                            <ul class="row-dropdown-options">
                                <li (click)="onDeleteDocumentClick(document)">Delete</li>
                                <li (click)="onUploadVersionClick(document)">Upload version</li>
                            </ul>
                        </co-dropdown-panel>
                    </div>
                </ng-container>
                <ng-template #lastVersionTemplate>
                    <div class="td check">
                        <co-checkbox [disabled]="isCompare || (selectedDocuments.length == 2 && !document.versions![0].selected)" [value]="document.versions![0].selected" (valueChange)="onCheck($event, document.versions![0])"></co-checkbox>
                    </div>
                    <div class="td name" (click)="onDocumentClick(document)">{{document.versions![0].name}}</div>
                    <div class="td">{{document.versions![0].name!.split('.')[0]}}</div>
                    <div class="td"><span class="status" [class.completed]="document.status == 'Completed'" [class.in-progress]="document.status == 'In progress'">{{document.status}}</span></div>
                    <div class="td center">{{document.versions?.length}}</div>
                    <div class="td">{{document.versions![0].createdDate | date: "dd.MM.YYYY" }}</div>
                    <div class="td actions">
                        <svg [dropdownTriggerFor]="dropdown" class=".row-options-btn" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <circle cx="12" cy="12" r="12" fill="#F5F5F6"/>
                            <circle cx="12" cy="6" r="2" fill="#606C82"/>
                            <circle cx="12" cy="12" r="2" fill="#606C82"/>
                            <circle cx="12" cy="18" r="2" fill="#606C82"/>
                        </svg>
                        <co-dropdown-panel #dropdown>
                            <ul class="row-dropdown-options">
                                <li (click)="onDeleteVersionClick(document, document.versions![0])">Delete</li>
                                <li (click)="onUploadVersionClick(document)">Upload version</li>
                            </ul>
                        </co-dropdown-panel>
                    </div>
                </ng-template>
                <div class="sub-grid-wrapper" *ngIf="document.id == expandedDocument?.id">
                    <div class="sub-grid" *ngIf="expandedDocument?.versions?.length; else emptyVersionsTemplate">
                        <div class="row">
                            <div class="th"></div>
                            <div class="th">Revision</div>
                            <div class="th">Description</div>
                            <div class="th">Date</div>
                            <div class="th"></div>
                        </div>
                        <div class="row" [class.background]="i % 2 == 0" *ngFor="let version of expandedDocument?.versions | slice:1; index as i;">
                            <div class="td check">
                                <co-checkbox [disabled]="isCompare || (selectedDocuments.length == 2 && !version.selected)" [value]="version.selected" (valueChange)="onCheck($event, version)"></co-checkbox>
                            </div>
                            <div class="td name" (click)="onDocumentClick(version)">{{version.version | number : '2.0-2'}}</div>
                            <div class="td">{{version.description}}</div>
                            <div class="td">{{document.createdDate | date: "dd.MM.YYYY" }}</div>
                            <div class="td actions">
                                <!-- <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path fill-rule="evenodd" clip-rule="evenodd" d="M3 10.4C3 8.15979 3 7.03969 3.43597 6.18404C3.81947 5.43139 4.43139 4.81947 5.18404 4.43597C6.03969 4 7.15979 4 9.4 4H14.6C16.8402 4 17.9603 4 18.816 4.43597C19.5686 4.81947 20.1805 5.43139 20.564 6.18404C21 7.03969 21 8.15979 21 10.4V11.6C21 13.8402 21 14.9603 20.564 15.816C20.1805 16.5686 19.5686 17.1805 18.816 17.564C17.9603 18 16.8402 18 14.6 18H7.41421C7.149 18 6.89464 18.1054 6.70711 18.2929L4.70711 20.2929C4.07714 20.9229 3 20.4767 3 19.5858V18V13V10.4ZM9 8C8.44772 8 8 8.44772 8 9C8 9.55228 8.44772 10 9 10H15C15.5523 10 16 9.55228 16 9C16 8.44772 15.5523 8 15 8H9ZM9 12C8.44772 12 8 12.4477 8 13C8 13.5523 8.44772 14 9 14H12C12.5523 14 13 13.5523 13 13C13 12.4477 12.5523 12 12 12H9Z" fill="#E1E4EA"/>
                                </svg> -->
                                <svg [dropdownTriggerFor]="dropdown" class=".row-options-btn" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <circle cx="12" cy="12" r="12" fill="#F5F5F6"/>
                                    <circle cx="12" cy="6" r="2" fill="#606C82"/>
                                    <circle cx="12" cy="12" r="2" fill="#606C82"/>
                                    <circle cx="12" cy="18" r="2" fill="#606C82"/>
                                </svg>
                                <co-dropdown-panel #dropdown>
                                    <ul class="row-dropdown-options">
                                        <li (click)="onDeleteVersionClick(document, version)">Delete</li>
                                    </ul>
                                </co-dropdown-panel>
                            </div>
                        </div>
                        <div class="row" [class.background]="expandedDocument?.versions!.length % 2 == 1">
                            <div class="td check">
                                <co-checkbox [disabled]="isCompare || (selectedDocuments.length == 2 && !document.selected)" [value]="document.selected" (valueChange)="onCheck($event, document)"></co-checkbox>
                            </div>
                            <div class="td name" (click)="onDocumentClick(document)">00</div>
                            <div class="td">...</div>
                            <div class="td">{{document.createdDate | date: "dd.MM.YYYY" }}</div>
                            <div class="td actions">
                                <!-- <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path fill-rule="evenodd" clip-rule="evenodd" d="M3 10.4C3 8.15979 3 7.03969 3.43597 6.18404C3.81947 5.43139 4.43139 4.81947 5.18404 4.43597C6.03969 4 7.15979 4 9.4 4H14.6C16.8402 4 17.9603 4 18.816 4.43597C19.5686 4.81947 20.1805 5.43139 20.564 6.18404C21 7.03969 21 8.15979 21 10.4V11.6C21 13.8402 21 14.9603 20.564 15.816C20.1805 16.5686 19.5686 17.1805 18.816 17.564C17.9603 18 16.8402 18 14.6 18H7.41421C7.149 18 6.89464 18.1054 6.70711 18.2929L4.70711 20.2929C4.07714 20.9229 3 20.4767 3 19.5858V18V13V10.4ZM9 8C8.44772 8 8 8.44772 8 9C8 9.55228 8.44772 10 9 10H15C15.5523 10 16 9.55228 16 9C16 8.44772 15.5523 8 15 8H9ZM9 12C8.44772 12 8 12.4477 8 13C8 13.5523 8.44772 14 9 14H12C12.5523 14 13 13.5523 13 13C13 12.4477 12.5523 12 12 12H9Z" fill="#E1E4EA"/>
                                </svg> -->
                               <!--  <svg [dropdownTriggerFor]="dropdown" class=".row-options-btn" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <circle cx="12" cy="12" r="12" fill="#F5F5F6"/>
                                    <circle cx="12" cy="6" r="2" fill="#606C82"/>
                                    <circle cx="12" cy="12" r="2" fill="#606C82"/>
                                    <circle cx="12" cy="18" r="2" fill="#606C82"/>
                                </svg>
                                <co-dropdown-panel #dropdown>
                                    <ul class="row-dropdown-options">
                                        <li (click)="onDeleteDocumentClick(document)">Delete</li>
                                    </ul>
                                </co-dropdown-panel> -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<app-viewer-panel
    *ngIf="isCompare && !viewDocument"
    [mode]="'compare'"
    [backgroundDocument]="selectedDocuments[0]"
    [overlayDocument]="selectedDocuments[1]"
    (onClose)="onCloseCompare()">
</app-viewer-panel>

<app-viewer-panel
    *ngIf="!isCompare && viewDocument"
    [mode]="'view'"
    [viewDocument]="viewDocument"
    (onClose)="onCloseView()">
</app-viewer-panel>

<ng-template #emptyVersionsTemplate>
    <div style="display: flex; align-items: center; justify-content: center; font-style: italic; height: 54px;">The document currently has no versions.</div>
</ng-template>

<input
    type="file"
    style="display: none;"
    #documentUpload
    accept=".pdf, .dwg, .dgn, .plt"
    onclick="this.value = null;"
    (change)="onDocumentUpload($event)" />

<input
    type="file"
    style="display: none;"
    #versionUpload
    accept=".pdf, .dwg, .dgn, .plt"
    onclick="clickedDocument = undefined; this.value = null;"
    (change)="onDocumentVersionUpload($event)" />